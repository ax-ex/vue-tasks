<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>vue-task-1</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="v-tooltip.css">

    <style>
        .btn-copy-surname {
            min-width: 110px;
        }

        tbody .tb-first-col {
            max-width: 100px
        }
    </style>
</head>

<body>
    <div id="app" v-cloak>
        <div class="container">
            <div class="row py-3">
                <div class="col">
                    <h2 class="text-center">Список пользователей</h2>
                </div>
            </div>
            <div class="row justify-content-between align-items-center py-2">
                <div class="col col-6">
                    Всего пользователей: {{ getNumberOfUsers }}
                </div>
                <div class="col col-6 text-right">
                    <button type="button" class="btn btn-outline-success btn-sm" v-tooltip.top-start="showListTooltip"
                        v-on:click="toggleShowList">{{ showBtnText }}</button>
                </div>
            </div>
            <div class="row">
                <table class="table table-striped">
                    <thead class="table-success">
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col"></th>
                            <th scope="col">Имя</th>
                            <th scope="col">Фамилия</th>
                            <th scope="col">Отчество</th>
                        </tr>
                    </thead>
                    <tbody v-show="showList">
                        <tr v-for="user in users" :key="user.id">
                            <th class="tb-first-col" scope="row">{{ user.id }}</th>
                            <td class="align-middle">
                                <img alt="" class="rounded-circle w-25" v-bind:src="user.icon_url || defaultImgUrl">
                            </td>
                            <td class="align-middle">{{ user.name | toUpperCase }}</td>
                            <td class="align-middle">
                                <div class="row justify-content-between">
                                    <div class="col">{{ user.surname }}</div>
                                    <div class="col">
                                        <button type="button" class="btn btn-outline-secondary btn-sm btn-copy-surname"
                                            v-copy="user.surname" v-on:click="handleCopied($event)"
                                            v-tooltip.top-start="copySurnameTooltip">копировать</button>
                                    </div>
                                </div>
                            </td>
                            <td class="align-middle">{{ user.patronimic }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="users-data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.7/dist/vue.js"></script>
    <script src="https://unpkg.com/v-copy"></script>
    <script src="https://unpkg.com/v-tooltip"></script>

    <script>
        var vm = new Vue({
            el: '#app',
            data: function () {
                return {
                    users: [],
                    showBtnText: 'Скрыть список',
                    showList: true,
                    showListTooltip: 'Показать/скрыть список',
                    copySurnameTooltip: 'Скопировать фамилию в буфер',
                    defaultImgUrl: 'https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y'
                }
            },
            mounted: function () {
                this.users = usersData
            },
            computed: {
                getNumberOfUsers: function () {
                    return this.users.length
                }
            },
            methods: {
                toggleShowList: function () {
                    this.showList = !this.showList
                    this.showBtnText = (this.showList) ? 'Скрыть список' : 'Показать список'
                },
                handleCopied: function (event) {
                    event.target.innerText = 'скопированно'
                    setTimeout(function () {
                        event.target.innerText = 'копировать'
                    }, 1500)
                }
            },
            filters: {
                toUpperCase: function (value) {
                    if (!value) return
                    value = value.toString()
                    return value.toUpperCase()
                }
            }
        })
    </script>
</body>

</html>